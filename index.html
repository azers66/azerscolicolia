<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Colicoli - Vérifier un livreur</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="colibri_enhaut.png">
</head>
<body>
  <header class="navbar">
    <div class="navbar-content">
      <a href="https://www.colicoli.fr" style="display:inline-block;"><img src="logo-colicoli.png" alt="Logo Colicoli" class="navbar-logo-img"></a>
    </div>
  </header>
  <div class="main-bg">
    <div id="main-content">
      <h2 class="main-title">Vérifier un livreur Colicoli</h2>
      <div class="verification-card">
        <div class="verification-content">
          <p class="instruction">
            Entrez le numéro d’identification du livreur pour confirmer qu’il<br>
            est enregistré auprès de Colicoli.
          </p>
          <input type="text" class="input-id" placeholder="Numéro d’identification / Badge">
          <button class="verify-btn">Vérifier le livreur</button>
          <div class="verify-message" style="min-height:28px;margin-top:8px;font-size:18px;font-weight:500;"></div>
          <div class="bottom-row">
            <span>Comment trouver le numéro d’identification&nbsp;?</span>
            <button class="contact-btn">Nous contacter</button>
          </div>
        </div>
        <div class="verification-image">
          <img src="livreur-colicoli.png" alt="Livreur Colicoli" class="livreur-img">
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const mainContent = document.getElementById('main-content');
      const contactBtnHtml = '<button class="contact-btn" style="margin-top:18px;">Nous contacter</button>';

      /**
       * Affiche le formulaire principal de vérification
       * Cette fonction génère le HTML du formulaire avec le champ de saisie
       */
      function renderForm() {
        mainContent.innerHTML = `
          <h2 class="main-title">Vérifier un livreur Colicoli</h2>
          <div class="verification-card">
            <div class="verification-content">
              <p class="instruction">
                Entrez le numéro d’identification du livreur pour confirmer qu’il<br>
                est enregistré auprès de Colicoli.
              </p>
              <input type="text" class="input-id" placeholder="Numéro d’identification / Badge">
              <button class="verify-btn">Vérifier le livreur</button>
              <div class="verify-message" style="min-height:28px;margin-top:8px;font-size:18px;font-weight:500;"></div>
              <div class="bottom-row">
                <span>Comment trouver le numéro d’identification&nbsp;?</span>
                <button class="contact-btn">Nous contacter</button>
              </div>
            </div>
            <div class="verification-image">
              <img src="livreur-colicoli.png" alt="Livreur Colicoli" class="livreur-img">
            </div>
          </div>
        `;
        bindFormEvents();
        bindContactBtn();
      }

      /**
       * Affiche la page de succès quand un code valide est saisi
       * @param {string} num - Le numéro d'identification validé
       */
      function renderSuccess(num) {
        mainContent.innerHTML = `
          <h2 class="main-title">Livreur vérifié</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#e6ffe2"/>
                  <path d="M20 36L32 48L50 24" stroke="#1a7f1a" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div style="font-size:24px;font-weight:700;color:#1a7f1a;margin-bottom:10px;">Ce livreur est bien vérifié</div>
              <div style="font-size:20px;color:#222;margin-bottom:18px;">Numéro d’identification&nbsp;: <b>${num}</b></div>
              <div class="bottom-row" style="justify-content:center;">
                <button class="contact-btn">Nous contacter</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
      }

      /**
       * Affiche la fiche d'information du livreur
       * @param {string} num - Le numéro d'identification du livreur
       */
      function renderDriverInfo(num) {
        mainContent.innerHTML = `
          <h2 class="main-title">Fiche livreur Colicoli</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#e6ffe2"/>
                  <path d="M20 36L32 48L50 24" stroke="#1a7f1a" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div style="font-size:24px;font-weight:700;color:#1a7f1a;margin-bottom:10px;">Livreur vérifié</div>
              <div style="font-size:20px;color:#222;margin-bottom:24px;">Numéro d'identification&nbsp;: <b>${num}</b></div>
              
              <div class="driver-info-card">
                <div class="info-row">
                  <div class="info-label">Nom complet</div>
                  <div class="info-value">Thomas MARTIN</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Zone de livraison</div>
                  <div class="info-value">Île-de-France</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Statut</div>
                  <div class="info-value status-active">● Actif</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Numéro SIRET</div>
                  <div class="info-value">928 851 864 00019</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Date d'embauche</div>
                  <div class="info-value">15 mars 2024</div>
                </div>
              </div>
              
              <div class="bottom-row" style="justify-content:center;gap:16px;">
                <button class="contact-btn">Nous contacter</button>
                <button class="retry-btn" style="background:#fff;color:#054848;border:2px solid #054848;font-size:16px;font-weight:700;border-radius:7px;padding:10px 18px;cursor:pointer;transition:background 0.2s;">Nouvelle vérification</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
        bindRetryBtn();
      }

      /**
       * Affiche la fiche d'information du livreur Simon Triolet
       * @param {string} num - Le numéro d'identification du livreur
       */
      function renderDriverInfoSimon(num) {
        mainContent.innerHTML = `
          <h2 class="main-title">Fiche livreur Colicoli</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#e6ffe2"/>
                  <path d="M20 36L32 48L50 24" stroke="#1a7f1a" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div style="font-size:24px;font-weight:700;color:#1a7f1a;margin-bottom:10px;">Livreur vérifié</div>
              <div style="font-size:20px;color:#222;margin-bottom:24px;">Numéro d'identification&nbsp;: <b>${num}</b></div>
              
              <div class="driver-info-card">
                <div class="info-row">
                  <div class="info-label">Nom complet</div>
                  <div class="info-value">Simon TRIOLET</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Zone de livraison</div>
                  <div class="info-value">Île-de-France</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Statut</div>
                  <div class="info-value status-active">● Actif</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Numéro SIRET</div>
                  <div class="info-value">928 851 864 00019</div>
                </div>
                <div class="info-row">
                  <div class="info-label">Date d'embauche</div>
                  <div class="info-value">8 janvier 2024</div>
                </div>
              </div>
              
              <div class="bottom-row" style="justify-content:center;gap:16px;">
                <button class="contact-btn">Nous contacter</button>
                <button class="retry-btn" style="background:#fff;color:#054848;border:2px solid #054848;font-size:16px;font-weight:700;border-radius:7px;padding:10px 18px;cursor:pointer;transition:background 0.2s;">Nouvelle vérification</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
        bindRetryBtn();
      }

      /**
       * Affiche la page d'erreur quand un code invalide est saisi
       */
      function renderError() {
        mainContent.innerHTML = `
          <h2 class="main-title">Numéro d’identification mauvais</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#ffe2e2"/>
                  <path d="M24 24L46 46M46 24L24 46" stroke="#b80000" stroke-width="6" stroke-linecap="round"/>
                </svg>
              </div>
              <div style="font-size:22px;font-weight:700;color:#b80000;margin-bottom:10px;">Numéro d’identification mauvais</div>
              <div class="bottom-row" style="justify-content:center;gap:16px;">
                <button class="contact-btn">Nous contacter</button>
                <button class="retry-btn" style="background:#fff;color:#054848;border:2px solid #054848;font-size:16px;font-weight:700;border-radius:7px;padding:10px 18px;cursor:pointer;transition:background 0.2s;">Réessayer</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
        bindRetryBtn();
      }

      /**
       * Gère le clic sur le bouton "Nous contacter"
       * Redirige vers la page de contact Colicoli
       */
      function bindContactBtn() {
        const btn = document.querySelector('.contact-btn');
        if (btn) btn.addEventListener('click', function() {
          window.location.href = 'https://www.colicoli.fr/contact-colicoli';
        });
      }

      /**
       * Gère le clic sur le bouton "Réessayer"
       * Permet de revenir au formulaire précédent
       */
      function bindRetryBtn() {
        const btn = document.querySelector('.retry-btn');
        if (btn) btn.addEventListener('click', function() {
          history.back();
        });
      }

      /**
       * Gestion des événements du formulaire de vérification
       * Cette fonction gère la validation et la vérification des codes d'identification
       */
      function bindFormEvents() {
        const input = document.querySelector('.input-id');
        const btn = document.querySelector('.verify-btn');
        const msg = document.querySelector('.verify-message');
        
        // Événement de clic sur le bouton "Vérifier le livreur"
        btn.addEventListener('click', function() {
          // Récupération et nettoyage de la valeur saisie
          const value = input.value.trim();
          
          // Vérification 1: Si le champ est vide
          if (!value) {
            msg.textContent = '';
            input.focus();
            return;
          }
          
          // Vérification 2: Validation du format (exactement 8 chiffres)
          // Regex: ^\d{8}$ = commence par un chiffre, suivi de 7 autres chiffres, puis fin
          if (!/^\d{8}$/.test(value)) {
            msg.textContent = 'Le numéro doit contenir exactement 8 chiffres.';
            msg.style.color = '#b80000';
            input.focus();
            return;
          }
          
          // Vérification 3: Validation du code spécifique Colicoli
          // Format attendu: 21XXXX38 où XXXX sont quatre chiffres quelconques
          // Seuls les codes spéciaux 21123438 et 21456738 sont valides
          if (/^21\d{4}38$/.test(value)) {
            // Codes spéciaux pour afficher les fiches des livreurs
            if (value === '21123438') {
              history.pushState({page: 'driver_info', num: value}, '', '');
              renderDriverInfo(value);
            } else if (value === '21456738') {
              history.pushState({page: 'driver_info', num: value}, '', '');
              renderDriverInfoSimon(value);
            } else {
              // Autres codes au format 21XXXX38: affichage de l'erreur
              history.pushState({page: 'error'}, '', '');
              renderError();
            }
          } else {
            // Code invalide: affichage de l'erreur
            history.pushState({page: 'error'}, '', '');
            renderError();
          }
        });
        
        // Événement de saisie: effacement des messages d'erreur en temps réel
        input.addEventListener('input', function() {
          msg.textContent = '';
        });
      }

      // ===== INITIALISATION DE L'APPLICATION =====
      renderForm();
      
      /**
       * Gestion de la navigation dans l'historique du navigateur
       * Permet d'afficher la bonne page quand l'utilisateur utilise les boutons précédent/suivant
       */
      window.onpopstate = function(event) {
        if (!event.state || event.state.page === 'form') {
          renderForm();
        } else if (event.state.page === 'success') {
          renderSuccess(event.state.num);
        } else if (event.state.page === 'driver_info') {
          // Déterminer quelle fiche afficher selon le numéro
          if (event.state.num === '21456738') {
            renderDriverInfoSimon(event.state.num);
          } else {
            renderDriverInfo(event.state.num);
          }
        } else if (event.state.page === 'error') {
          renderError();
        }
      };
      
      // Initialisation de l'historique avec la page du formulaire
      history.replaceState({page: 'form'}, '', '');
    });
  </script>
</body>
</html>
