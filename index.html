<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Colicoli - Vérifier un livreur</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="colibri_enhaut.png">
</head>
<body>
  <header class="navbar">
    <div class="navbar-content">
      <a href="https://www.colicoli.fr" style="display:inline-block;"><img src="logo-colicoli.png" alt="Logo Colicoli" class="navbar-logo-img"></a>
    </div>
  </header>
  <div class="main-bg">
    <div id="main-content">
      <h2 class="main-title">Vérifier un livreur Colicoli</h2>
      <div class="verification-card">
        <div class="verification-content">
          <p class="instruction">
            Entrez le numéro d’identification du livreur pour confirmer qu’il<br>
            est enregistré auprès de Colicoli.
          </p>
          <input type="text" class="input-id" placeholder="Numéro d’identification / Badge">
          <button class="verify-btn">Vérifier le livreur</button>
          <div class="verify-message" style="min-height:28px;margin-top:8px;font-size:18px;font-weight:500;"></div>
          <div class="bottom-row">
            <span>Comment trouver le numéro d’identification&nbsp;?</span>
            <button class="contact-btn">Nous contacter</button>
          </div>
        </div>
        <div class="verification-image">
          <img src="livreur-colicoli.png" alt="Livreur Colicoli" class="livreur-img">
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const mainContent = document.getElementById('main-content');
      const contactBtnHtml = '<button class="contact-btn" style="margin-top:18px;">Nous contacter</button>';

      function renderForm() {
        mainContent.innerHTML = `
          <h2 class="main-title">Vérifier un livreur Colicoli</h2>
          <div class="verification-card">
            <div class="verification-content">
              <p class="instruction">
                Entrez le numéro d’identification du livreur pour confirmer qu’il<br>
                est enregistré auprès de Colicoli.
              </p>
              <input type="text" class="input-id" placeholder="Numéro d’identification / Badge">
              <button class="verify-btn">Vérifier le livreur</button>
              <div class="verify-message" style="min-height:28px;margin-top:8px;font-size:18px;font-weight:500;"></div>
              <div class="bottom-row">
                <span>Comment trouver le numéro d’identification&nbsp;?</span>
                <button class="contact-btn">Nous contacter</button>
              </div>
            </div>
            <div class="verification-image">
              <img src="livreur-colicoli.png" alt="Livreur Colicoli" class="livreur-img">
            </div>
          </div>
        `;
        bindFormEvents();
        bindContactBtn();
      }

      function renderSuccess(num) {
        mainContent.innerHTML = `
          <h2 class="main-title">Livreur vérifié</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#e6ffe2"/>
                  <path d="M20 36L32 48L50 24" stroke="#1a7f1a" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <div style="font-size:24px;font-weight:700;color:#1a7f1a;margin-bottom:10px;">Ce livreur est bien vérifié</div>
              <div style="font-size:20px;color:#222;margin-bottom:18px;">Numéro d’identification&nbsp;: <b>${num}</b></div>
              <div class="bottom-row" style="justify-content:center;">
                <button class="contact-btn">Nous contacter</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
      }

      function renderError() {
        mainContent.innerHTML = `
          <h2 class="main-title">Numéro d’identification mauvais</h2>
          <div class="verification-card" style="justify-content:center;">
            <div class="verification-content" style="align-items:center;text-align:center;">
              <div style="margin-bottom:18px;">
                <svg width="70" height="70" viewBox="0 0 70 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="35" cy="35" r="35" fill="#ffe2e2"/>
                  <path d="M24 24L46 46M46 24L24 46" stroke="#b80000" stroke-width="6" stroke-linecap="round"/>
                </svg>
              </div>
              <div style="font-size:22px;font-weight:700;color:#b80000;margin-bottom:10px;">Numéro d’identification mauvais</div>
              <div class="bottom-row" style="justify-content:center;gap:16px;">
                <button class="contact-btn">Nous contacter</button>
                <button class="retry-btn" style="background:#fff;color:#054848;border:2px solid #054848;font-size:16px;font-weight:700;border-radius:7px;padding:10px 18px;cursor:pointer;transition:background 0.2s;">Réessayer</button>
              </div>
            </div>
          </div>
        `;
        bindContactBtn();
        bindRetryBtn();
      }

      function bindContactBtn() {
        const btn = document.querySelector('.contact-btn');
        if (btn) btn.addEventListener('click', function() {
          window.location.href = 'https://www.colicoli.fr/contact-colicoli';
        });
      }

      function bindRetryBtn() {
        const btn = document.querySelector('.retry-btn');
        if (btn) btn.addEventListener('click', function() {
          history.back();
        });
      }

      function bindFormEvents() {
        const input = document.querySelector('.input-id');
        const btn = document.querySelector('.verify-btn');
        const msg = document.querySelector('.verify-message');
        btn.addEventListener('click', function() {
          const value = input.value.trim();
          if (!value) {
            msg.textContent = '';
            input.focus();
            return;
          }
          if (!/^\d{8}$/.test(value)) {
            msg.textContent = 'Le numéro doit contenir exactement 8 chiffres.';
            msg.style.color = '#b80000';
            input.focus();
            return;
          }
          if (/^2100\d{2}38$/.test(value)) {
            history.pushState({page: 'success', num: value}, '', '');
            renderSuccess(value);
          } else {
            history.pushState({page: 'error'}, '', '');
            renderError();
          }
        });
        input.addEventListener('input', function() {
          msg.textContent = '';
        });
      }

      // Initialisation
      renderForm();
      window.onpopstate = function(event) {
        if (!event.state || event.state.page === 'form') {
          renderForm();
        } else if (event.state.page === 'success') {
          renderSuccess(event.state.num);
        } else if (event.state.page === 'error') {
          renderError();
        }
      };
      // On charge la page initiale dans l'historique
      history.replaceState({page: 'form'}, '', '');
    });
  </script>
</body>
</html>